<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<title>Who's Who Complex Systems Society</title>
		<meta name="description" content="">
		<meta name="author" content="">
		<!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
		<!--[if lt IE 9]>
		<script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
		<![endif]-->
		<!-- Le styles -->
		<link href="css/bootstrap.css" rel="stylesheet">
		<link type="text/css" href="css/brownian-motion/jquery-ui-1.8.16.custom.css">
		<!--    <link rel="stylesheet/less" type="text/css" href="less/bootstrap.less">
		<script src="js/less-1.1.5.min.js" type="text/javascript"></script>
		-->
		<link href='http://fonts.googleapis.com/css?family=Ubuntu' rel='stylesheet' type='text/css'>
		<script type="text/javascript" src="js/jquery-1.7.min.js"></script>
		<script type="text/javascript" src="js/jquery-ui-1.8.16.custom.min.js"></script>
		<script type="text/javascript" src="js/bootstrap-dropdown-fade.js"></script>
		<script type="text/javascript" src="js/underscore.min.js"></script>
		<script type="text/javascript" src="js/jquery.highlight-3.js"></script>
		<style type="text/css">
body {
padding-top: 60px;
font-family: 'Ubuntu', sans-serif;
}
.topbar {
opacity: 0.93;
-webkit-box-shadow: 0 0px 10px rgba(0,0,0,.70);
-moz-box-shadow: 0 0px 10px rgba(0,0,0,.70);
box-shadow: 0 0px 10px rgba(0,0,0,.70);
}

#search-form #search-query {
border: 1px solid black;
-moz-border-radius: 4px;
-webkit-border-radius: 4px;
font: 13px Arial, sans-serif;
width: 180px;
padding: 6px 25px 4px 6px;
color: #ccc;
background: #666;
-webkit-box-shadow: 0 1px 0 #444;
-moz-box-shadow: 0 1px 0 #444;
box-shadow: 0 1px 0 #444;
}
#search-form #search-query:hover {
background: #777;
color: #fff;
}
#search-form span.glass {
display: block;
position: absolute;
cursor: pointer;
display: block;
right: 0;
padding: 7px 8px 5px 8px;
}
#search-form span.glass i {
background-image: url(css/sprite-icons.png);
background-position: -224px -96px;
width: 14px;
height: 14px;
display: block;
font-size: 0;
}
#search-form #search-query:focus, #search-form #search-query.focused {
outline: none;
background: #eee;
color: #333;
text-shadow: 0 1px 0 #fff;
border: 1px solid #eee;
-webkit-box-shadow: 0 0 3px #000;
-moz-box-shadow: 0 0 3px #000;
box-shadow: 0 0 3px #000;
}
.filter {
/*position:relative;
display: block;
top:50%;
margin-top:20px;*/
}
.filterselect {
background: rgba(220,220,220, 0.70);
border-color: rgba(0,0,0,0.2);
color: rgba(0,0,0,0.8);
height: 40px;
}

.ui-autocomplete-loading {
background: white url('css/ui-anim_basic_16x16.gif') right center no-repeat;
}
.ui-autocomplete-category {
font-weight: bold;
padding: .2em .4em;
margin: .8em 0 .2em;
line-height: 1.2;
}

.ui-autocomplete {
list-style: none;
background-color: #ffffff;
/*
float: left;
display: none;
position: absolute;
top: 40px;
*/
z-index: 900;
min-width: 18 	0px;
max-width: 300px;

margin: 0 auto; /*
margin-left: 0;
margin-right: 0;*/
padding: 5px 0;

border-color: #999;
border-color: rgba(0, 0, 0, 0.2);
border-style: solid;
border-width: 0 1px 1px;
-webkit-border-radius: 6px;
-moz-border-radius: 6px;
border-radius: 6px;
-webkit-box-shadow: 0 3px 4px rgba(0, 0, 0, 0.3);
-moz-box-shadow: 0 3px 4px rgba(0, 0, 0, 0.3);
box-shadow: 0 3px 4px rgba(0, 0, 0, 0.3);
-webkit-background-clip: padding-box;
-moz-background-clip: padding-box;
background-clip: padding-box;

}

.ui-menu-item {

display: block;
padding: 3px 12px;
clear: both;
font-weight: normal;
line-height: 18px;
color: #808080;
text-shadow: 0 1px 0 #ffffff;

}
/*
.ui-menu {
*/
/*
.ui-menu {
background: white;
}
*/
.highlight {
font-weight: bold;
}

		</style>
		<!-- Le fav and touch icons -->
		<link rel="shortcut icon" href="images/favicon.ico">
		<link rel="apple-touch-icon" href="images/apple-touch-icon.png">
		<link rel="apple-touch-icon" sizes="72x72" href="images/apple-touch-icon-72x72.png">
		<link rel="apple-touch-icon" sizes="114x114" href="images/apple-touch-icon-114x114.png">
	</head>
	<body>
		<script type="text/javascript">
			/**
			 * Prevents click-based selectiion of text in all matched elements.
			 */
			jQuery.fn.disableTextSelection = function() {
				return this.each(function() {
					if( typeof this.onselectstart != "undefined")// IE
					{
						this.onselectstart = function() {
							return false;
						};
					} else if( typeof this.style.MozUserSelect != "undefined")// Firefox
					{
						this.style.MozUserSelect = "none";
					} else// All others
					{
						this.onmousedown = function() {
							return false;
						};
						this.style.cursor = "default";
					}
				});
			};
			var ids = 0;
			var completion = {};
			
			$(document).ready(function() {
				/*
				 $.ajax({
				 url : "../community/getmenu.php",
				 dataType : "json",
				 success : function(msg) {

				 console.log(msg);
				 var cata = $("#categorya").get(0);
				 cata.options.length = 0;
				 cata.options[0] = new Option("Select gender", "-1");

				 $.each(msg.d, function(index, item) {
				 cata.options[cata.options.length] = new Option(item.Display, item.Value);
				 });
				 },
				 error : function() {
				 alert("Failed to load genders");
				 }
				 });
				 */
				$('#search-form').hide();

				$('.topbar').hover(function() {
					$(this).stop().animate({
						"opacity" : 0.98
					}, "fast");
				}, function() {
					$(this).stop().animate({
						"opacity" : 0.93
					}, "fast");
				});
				function popfilter(label, type, options) {
					var id = ids++;
					var id1 = "filter" + id;
					var id2 = "combo" + id;
		
					var header = '<li id="' + id1 + '" class="filter" style="padding-top: 5px;">';
					var labelization = '<span style="color: #fff;">&nbsp; ' + label + ' </span>';
					//var selection = '<select id="' + id2 + '" class="small filterselect filter' + type + '">' + options + '</select>';
					var input = '<input type="text" id="' + id2 + '" class="medium" placeholder="' + type + '" />';
					var footer = '</li>;'
					$(header + labelization + input
					// +     selection
					+ footer).insertBefore('#refine');

					$("#" + id2).catcomplete({
						minLength : 2,
						source : function(request, response) {
							var term = request.term;

							$.getJSON("autocomplete.php", {
								category : type,
								term : request.term
							}, function(data, status, xhr) {
									response(data.results);
							});
						}
					});

					$('#' + id1 + '').hide();
					$('#' + id1 + '').fadeIn(500);
					jQuery('#' + id1).disableTextSelection();
					return false;
				};


				$.widget("custom.catcomplete", $.ui.autocomplete, {
					_renderMenu : function(ul, items) {

						var self = this, categories = _.groupBy(items, function(o) {
							return o.category;
						});

						_.each(categories, function(data, category) {
							var size = 0;
							var total = 0;
							var term = "";
							_.each(data, function(item) {
								size = item.size;
								total = item.total;
								term = item.term;
								self._renderItem(ul, item);
							});
							ul.append("<li class='ui-autocomplete-category'>"+size+"/" + total + " results</li>");
							console.log(term);
							ul.highlight(term);
						});
					}
				});
				jQuery('#mapping').disableTextSelection();

				var cache = {};
				var xhrs = {};

				$('#addfiltercountry').click(function() {
					return popfilter('in', 'countries', []);
				});
				$('#addfilterorganization').click(function() {

					return popfilter('from', 'organizations', []);
				});
				$('#addfilterlaboratory').click(function() {
					var prefix = "working";
					if($(".filterkeywords") || $(".filterlaboratories")) {
						//prefix = "";
					}
					return popfilter(prefix + ' at', 'laboratories', []);

				});

				$('#addfilterkeyword').click(function() {
					var prefix = "working";
					if($(".filterkeywords") || $(".filterlaboratories")) {
						//prefix = "";
					}
					return popfilter(prefix + ' on', 'keywords', []);
				});
				$('#addfiltertag').click(function() {
					return popfilter('tagged', 'tags', []);
				});
				/*
				 $.ajax({
				 url : "../community/getmenu.php",
				 dataType : "json",
				 success : function(msg) {

				 console.log(msg);
				 var cata = $("#categorya").get(0);
				 cata.options.length = 0;
				 cata.options[0] = new Option("Select gender", "-1");

				 $.each(msg.d, function(index, item) {
				 cata.options[cata.options.length] = new Option(item.Display, item.Value);
				 });
				 },
				 error : function() {
				 alert("Failed to load genders");
				 }
				 });
				 */

				$('#loading').hide();
				$('#example').click(function() {
					$('#welcome').toggle('slow', function() {
						$('#loading').toggle('slow');
					});
				});
				$('#generate').click(function() {
					$('#welcome').fadeOut('fasy', function() {
						$('#loading').fadeIn('slow', function() {
							var collect = function(k) {
								var t = [];
								$('.filter' + k + ' :selected').each(function(i, e) {
									console.log("selected " + i + " = " + e);
									t.push($(e).text());
								});
								return t;
							}
							var query = {
								categorya : $('#categorya :selected').text(),
								categoryb : $('#categoryb :selected').text(),
								keywords : collect('keywords'),
								countries : collect('countries'),
								laboratories : collect('laboratories'),
								coloredby : [],
								tags : collect('tags'),
								organizations : collect('organizations')
							};

							console.log(query);
							/*
							 $.post("../community/gexf.php", query, function(data) {
							 $('#loading').hide('slow', function() {
							 // display the TINAVIZ PANEL
							 });
							 });
							 */
						});
					});
					return false;
				});
			});

		</script>
		<div class="topbar" data-dropdown="dropdown">
			<div class="topbar-inner">
				<div class="container-fluid">
					<a class="brand" href="#">Who's Who</a>
					<ul class="nav">
						<li id="mapping" style="margin-top:5px;">
							<span style="color: #fff;">Map </span>
							<select id="categorya" class="small" style="background: rgb(220,255,220, 0.8);">
								<option>Scholars</option>
								<option>Labs</option>
								<option selected="true">Keywords</option>
								<option>Organizations</option>
								<option>Countries</option>
							</select>
							<span style="color: #fff;"> and </span>
							<select id="categoryb" class="small" style="background: rgb(255,220,220, 0.8);">
								<option selected="true">Scholars</option>
								<option>Labs</option>
								<option>Organizations</option>
								<option>Countries</option>
							</select>
						</li>
						<!--
						<li class="dropdown">
						<a class="dropdown-toggle"><strong>working on</strong> Optics, Econometrics</a>
						<ul class="dropdown-menu">
						<li>
						<a href="#">Change filter</a>
						</li>
						<li>
						<a href="#">Delete filter</a>
						</li>
						</ul>
						</li>
						-->
						<li id="refine" class="dropdown">
							<a class="dropdown-toggle">refine</a>
							<ul class="dropdown-menu">
								<li>
									<a id="addfiltercountry" href="#">Filter by country</a>
								</li>
								<li>
									<a id="addfilterorganization" href="#">Filter by organization</a>
								</li>
								<li>
									<a id="addfilterlaboratory" href="#">Filter by laboratory</a>
								</li>
								<li>
									<a id="addfilterkeyword" href="#">Filter by keyword</a>
								</li>
								<li>
									<a id="addfiltertag" href="#">Filter by #tag</a>
								</li>
								<li>
									<a id="addcolor" href="#">Color by</a>
								</li>
							</ul>
						</li>
						<li style="">
							<a id="generate" href="#generate"> GO!</a>
						</li>
					</ul>
					<form id="search-form" class="js-search-form pull-right">
						<span class="glass js-search-action"><i></i></span>
						<input id="search" class="input-small" type="text" name="q" placeholder="Search">
						<!--<input type="text" id="search" name="search" placeholder="Scholars">-->
						<!--
						<li class="ui-state-default ui-corner-all" title=".ui-icon-search"><span class="ui-icon ui-icon-search"></span></li>

						<button class="btn" type="submit"></button>
						-->
					</form>
				</div>
			</div>
		</div>
		<div class="container-fluid">
			<div class="sidebar">
				<div class="well">
					<h5>David Chavalarias</h5>
					<ul>
						<li>
							<a href="#">Link</a>
						</li>
						<li>
							<a href="#">Link</a>
						</li>
						<li>
							<a href="#">Link</a>
						</li>
						<li>
							<a href="#">Link</a>
						</li>
					</ul>
					<h5>Something</h5>
					<ul>
						<li>
							<a href="#">Link</a>
						</li>
						<li>
							<a href="#">Link</a>
						</li>
						<li>
							<a href="#">Link</a>
						</li>
						<li>
							<a href="#">Link</a>
						</li>
						<li>
							<a href="#">Link</a>
						</li>
						<li>
							<a href="#">Link</a>
						</li>
					</ul>
					<h5>Something Else</h5>
					<ul>
						<li>
							<a href="#">Link</a>
						</li>
						<li>
							<a href="#">Link</a>
						</li>
					</ul>
				</div>
			</div>
			<div class="content">
				<!-- Main hero unit for a primary marketing message or call to action -->
				<div class="hero-unit">
					<div id="loading" style="padding-left=-175px; margin-left: 27%;">
						<img src="css/loading.gif" style="border: 0px; opacity: 0.05; " />
					</div>
					<div id="welcome">
						<h2>Welcome to the Who's Who, the network of CSS Members</h2>.
						<p>
							To start browsing use the <strong>new interactive menu</strong> on the top of the webpage!
						</p>
						If you cannot find yourself in the net or want to update your data,
						please go to the <a href="http://main.csregistry.org/Whoswhodata">registration page</a>.
						<br/>
						If you attented ECC11 you are a CSS member
						although there could be some delay untill you are registered as such. <a href="http://main.csregistry.org/my+account">Check your CSS membership statute</a>
						</p>
						<p>
							<a id="example" class="btn primary large">See the Scholars &raquo;</a>
						</p>
					</div>
				</div>
				<footer>
					<a href="http://iscpif.fr"><img src="css/branding/logo-iscpif_medium.png" alt="iscpif.fr" style="border: none; margin-bottom : -6px;" title="isc-pif" /></a>- &copy; <a href="http://moma.csregistry.org" target="_BLANK">MOMA</a> - <a href="http://www.crea.polytechnique.fr/LeCREA/" target="_BLANK">CREA</a> - <a href="http://www.cnrs.fr/fr/recherche/index.htm" target="_BLANK">CNRS</a> - 2009-2012
				</footer>
			</div>
		</div>
	</body>
</html>