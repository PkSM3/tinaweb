<!DOCTYPE HTML PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xml:lang="en-GB" xmlns="http://www.w3.org/1999/xhtml">
    <head>
        <title>example</title>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <meta name="description" content="example">
        <meta name="keywords" content="example">
        <link rel="shortcut icon" href="favicon.ico" type="image/x-icon">
            
        <!-- JQUERY -->
        <script type="text/javascript" src="js/jquery-1.4.2.min.js" language="javascript"></script>
        <!-- JQUERY UI -->
        <script type="text/javascript" src="js/jquery-ui-1.8.min.js" language="javascript"></script>
        <!-- JQUERY UI CSS -->
        <link type="text/css" rel="stylesheet" href="css/smoothness/jquery-ui-1.8.custom.css"/>

        <!-- UTILITIES -->
        <!--<script type="text/javascript" src="js/themelia/nalarium.trace.js" language="javascript"></script>-->
        <!--<script type="text/javascript" src="js/tenjin/shotenjin.js" language="javascript"></script>-->
        
        <!-- JQUERY UI -->
        <!--<script type="text/javascript" src="js/jquery/jquery.ui.all.js" language="javascript"></script>-->
        <!--<link type="text/css" rel="stylesheet" href="css/eggplant/jquery-ui-1.7.2.custom.css"/>-->

        <!-- JQUERY UI ADD-ONS -->
        <!--<script type="text/javascript"  src="js/jquery/jquery.rating.pack.js" language="javascript"></script> 
        <link type="text/css" rel="stylesheet" href="js/jquery/jquery.rating.css"/> -->

        <!-- TINASOFT APP -->
        <link type="text/css" rel="stylesheet" href="example.css"/>
        
        <link rel="stylesheet" type="text/css" href="css/reset-fonts-grids.css">
        <link rel="stylesheet" type="text/css" href="css/base.css">
    </head>
    <body>
  <script type="text/javascript"> 
  
 /* useful for fullscreen mode */
function getScreenWidth() {
    var x = 0;
    if (self.innerHeight) {
            x = self.innerWidth;
    }
    else if (document.documentElement && document.documentElement.clientHeight) {
            x = document.documentElement.clientWidth;
    }
    else if (document.body) {
            x = document.body.clientWidth;
    }
    return x;
}

/* useful for fullscreen mode */
function getScreenHeight() {
    var y = 0;
    if (self.innerHeight) {
        y = self.innerHeight;
    }
    else if (document.documentElement && document.documentElement.clientHeight) {
        y = document.documentElement.clientHeight;
    }
    else if (document.body) {
        y = document.body.clientHeight;
    }
    return y;
}

function Tinaviz() {

  var wrapper = null;
  var applet = null;

  return {
  
     // MAIN PROGRAM
     main: function() {
        this.setLevel("macro"); 
        applet.setAntiAliasing(true);
        //applet.setBezier(64); // 18: default   64: high quality
        
	applet.dispatchProperty("category/value", "NGram");
        applet.dispatchProperty("category/mode", "keep");
	    
	//this.bindFilter("Category",  "category", "macro");
		
	// bipartite_graph_cooccurrences_.gexf
        this.readGraph("macro", "gexf/test.gexf");
        
     },

     // APPLET INITIALIZED CALLBACK
     init: function() {
        if (wrapper != null || applet != null) return;
        wrapper = $('#vizframe').contents().find('#tinaviz')[0];
        applet = wrapper;
        this.size(this.getWidth(), this.getHeight());
        this.main();
    },
    
    // RESIZE THE APPLET
    size: function(width, height) {
        wrapper.width = width;
        wrapper.height = height;
        $('#vizframe').css('width',""+ width + "px");
        $('#vizframe').css('height',"" + height +"px");
    },
    
    readGraph: function(view,graphURL) {
        if (applet == null) return;
        $.ajax({
		    url: graphURL,
		    type: "GET",
	        dataType: "text",
	        beforeSend: function() { $('#loading').show(); },
            error: function() { $('#loading').hide(); },
	        success: function(gexf) { 
	           applet.getSession().updateFromString(view,gexf);
	           $('#loading').hide();
	       } 
        });
    },
    
    openGraph: function(view,relativePath) {
        if (applet == null) return;
	    applet.getSession().updateFromURI(view,path);
    },

    toggleLabels: function() {
        if (applet == null) return;
        return applet.getView().toggleLabels(); 
    },
    toggleNodes: function() {
        if (applet == null) return;
        return applet.getView().toggleNodes();
    },
    toggleEdges: function() {
        if (applet == null) return;
        return applet.getView().toggleLinks();
    },
    togglePause: function() {
        if (applet == null) return;
        return applet.getView().togglePause();
    },
    toggleHD: function() {
        if (applet == null) return;
        return applet.getView().toggleHD();
    },
    setLevel: function(level) {
        if (applet == null) return;
        applet.getSession().setLevel(level);
    },
/*
    bindFilter: function(name, path, level) {
        if (applet == null) return;
        if (level == null) return applet.getSession().addFilter("tinaviz.filters."+name, path);
        return applet.getView(level).addFilter("tinaviz.filters."+name, path);
    },
    */   
    bindFilter: function(name, path, level) {
        if (applet == null) return;
        if (level == null) return applet.getSession().addFilter(name, path);
        return applet.getView(level).addFilter(name, path);
    }, 
     
    dispatchProperty: function(key,value) {
        if (applet == null) return;
        return applet.getSession().setProperty(key,value);
    },
    
    setProperty: function(level,key,value) {
        if (applet == null) return;
        return applet.getView(level).setProperty(key,value);
    },
    
    getProperty: function(level,key,value) {
        if (applet == null) return;
        return applet.getView(level).getProperty(key);
    },
    
    search: function(txt) {
        this.logNormal("Searching is not implemented yet..");
    },


    unselect: function() {
        if (applet != null)  applet.unselect();
        this.setProperty("meso", "subgraph/item", "");
        applet.clear("meso");
    },
    
    recenter: function() {
        if (applet == null) return false;
        return applet.recenter();
    },
    
    nodeSelected: function(level,x,y,id,label,attr) {
    },

    enabled: function() {
        if (applet == null) {
            return false;
        } else {
            return applet.isEnabled();
        }
    },
    enable:  function() {
        if (applet == null) return;
        applet.setEnabled(true);
    },
    
    disable:  function() {
        if (applet == null) return;
        applet.setEnabled(false);
    },
    
    logError: function(msg) {
    },
    logNormal: function(msg) {
    },
    logDebug: function(msg) {
    },
    switchedTo: function(level) {
    },

    getWidth: function() {
       return getScreenWidth() - 28;
    },
    getHeight: function() {
       return getScreenHeight() - 150;
    }
  };
}

tinaviz = new Tinaviz();

    $(function(){

        $('#loading').hide();
    
         $('#toolbar input[type=file]').change(function(e){
          tinaviz.clear();
          tinaviz.loadAbsoluteGraph( $(this).val() );
        });




		$('#pause').button({
			text: false,
			icons: {
				primary: 'ui-icon-pause'
			}
		});
		/*
		.click(function() {
			var options;
			if ($(this).text() == 'play') {
				options = {
					label: 'pause',
					icons: {
						primary: 'ui-icon-pause'
					}
				};
			} else {
				options = {
					label: 'play',
					icons: {
						primary: 'ui-icon-play'
					}
				};
			}
			$(this).button('option', options);
		});*/
		/*
		$('#stop').button({
			text: false,
			icons: {
				primary: 'ui-icon-stop'
			}
		})
		.click(function() {
			$('#play').button('option', {
				label: 'play',
				icons: {
					primary: 'ui-icon-play'
				}
			});
		});*/
		
		$('#recenter').button({
			text: false,
			icons: {
				primary: 'ui-icon-seek-next'
			}
		}).click(function() {
		
        });

		$("#toggles").buttonset();
		
    	$('#nodes').button({
			text: "nodes",
			icons: {
				primary: 'ui-icon-nodes'
			}
		}).click(function() {
		    tinaviz.toggleNodes();
        });
    	$('#edges').button({
			text: "edges",
			icons: {
				primary: 'ui-icon-edges'
			}
		}).click(function() {
		    tinaviz.toggleEdges();
        });
    	$('#labels').button({
			text: "labels",
			icons: {
				primary: 'ui-icon-labels'
			}
		}).click(function() {
		    tinaviz.toggleLabels();
        });
		
    	$('#reset').button({
			text: "reset",
			icons: {
				primary: 'ui-icon-thunder'
			}
		}).click(function() {
		    
		    tinaviz.recenter();
        });
		
    });
        </script>
        
        <div id="doc3" class="yui-t6">
	        <div id="hd">
	            <div id="hdt">
                    <div class="hdl">
                             <h1>FET Open : Project Explorer</h1>
                             <p></p>
                    </div>
                    <div class="hdr">
                             <img src="css/partners.jpg" />
                    </div>
                </div>
                <div id="hdb">
                    <div class="toolbardiv">
	                    <span id="toolbar" class="ui-widget-header ui-corner-all">
	                        <input id="inputgraph" type="file" size="2" style="height: 15px; opacity: 0; width: 10px;">Open</input>
		                    <button id="pause">pause</button>
		                    <button id="reset">reset</button>

		                    <span id="toggles">
			                    <input type="checkbox"  id="nodes" name="nodes" checked="checked" /><label for="nodes">nodes</label>
			                    <input type="checkbox"  id="labels" name="labels" /><label for="labels">labels</label>
			                    <input type="checkbox"  id="edges" name="edges" /><label for="edges">edges</label>
		                    </span>
	                    </span>
                    </div>
                </div>
	        </div>
	        <div id="bd">
		        <div id="yui-main">
			        <div class="yui-b">
				        <!-- PUT MAIN COLUMN CODE HERE -->
				        
				        <div class="visualization">
                            
            <!--<a href="" onclick="$('vizframe').src='tinaviz/software.html'">software</a> / <a href="" onclick="$('vizframe').src='tinaviz/hardware.html'">hardware</a>-->

                            <!--<div class="ui-widget ui-widget-content ui-corner-all formleft infodiv detailtext">-->
                            <iframe id="vizframe" class="vizframe" allowtransparency="true" scrolling="no" frameborder="0" src="tinaviz/software.html"></iframe>
                            <!--</div>-->
                        </div><!-- end of visualization -->
			        </div><!-- end of yui-b -->
		        </div><!-- end of yui-main -->
		        <div class="yui-b">
			        <div id="loading"><img src="css/loading.gif" />Loading..</div>
		        </div>
	        </div>
	        <div id="ft">
		        <span>Copyright MOMA, CREA, CNRS - 2009, 2010, 2011.</span>
	        </div>
        </div>
    </body>
</html>






